<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mixnet Uptime</title>
    <meta name="viewport" content="width=device-width,i
nitial-scale=1"/>
    <script src="https://momentjs.com/downloads/moment.min.js"></script>
</head>
<body>
<style>
	      body {
	      	margin: 0;
	            position: absolute;
	            top: 50%;
	            left: 50%;
	            margin-right: -50%;
	            transform: translate(-50%,-50%);
	            font-family: Consolas;
	      }

	      dt, dd {
	    	display: block;
	             margin-top: 20px;
	        }

	      dt {
	          	clear: both;
	        }

	      img {
	          	display: block;
	            margin-left: auto;
	            margin-right: auto;
	        }
	     p {
     width: 500px;
     white-space: normal;
     overflow: visible;
     text-overflow: clip;
}
	      /* Add a black background color to the top navigati
on */
.topnav {
  background-color: #333;
  overflow: hidden;
}

/* Style the links inside the navigation bar */
.topnav a {
  float: left;
  color: #f2f2f2;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
  font-size: 17px;
}

/* Change the color of links on hover */
.topnav a:hover {
  background-color: #ddd;
  color: black;
}

/* Add a color to the active/current link */
.topnav a.active {
  background-color: #04AA6D;
  color: white;
}

</style>


<h2>Is mixnet working ?</h2>
<a href="https://explorer.nymtech.net/">Nym's mixnet</a> is <b id="state">working</b> <a id="uptime"></a>
<br/>
<small><a href="https://validator.nymtech.net/api/v1/epoch/current">Validator API</a> is <b id="stateValidator">working</b> </small>
<br/>
<br/>
<small>Last update: <a id="lastUpdate"></a></small>
<br/>
<br/>
<small style="color: gray; text-align: center;padding-left: 1em;">
    <a style="color: gray;" href="https://nym.notrustverify.ch">No Trust Verify</a>  - <a style="color: gray;" href="https://t.me/notrustverify">Join us on Telegram</a> - <a  style="color: gray;" href="https://nymtech.net/">Nym</a>
</small>
<script>


async function get() {
    let url = '{{api_url}}/api/state'
    let obj = await (await fetch(url)).json();

    //console.log(obj);
    return obj;
}

var states;
(async () => {
  states = await get()
  //console.log(tags)
  if (JSON.stringify(states.mixnet_working) == "true")
    document.getElementById("state").innerHTML = "working";
  else
    document.getElementById("state").innerHTML = "not working";

  if (JSON.stringify(states.validator_working) == "true")
    document.getElementById("stateValidator").innerHTML = "working";
  else
    document.getElementById("stateValidator").innerHTML = "not working";

  document.getElementById("lastUpdate").innerHTML = moment(JSON.stringify(states.last_update).slice(1,-1));
  document.getElementById("uptime").innerHTML = "since " + moment(JSON.stringify(states.last_downtime).slice(1,-1)).fromNow().replace("in","");

})()


</script>
</body>

</html>
